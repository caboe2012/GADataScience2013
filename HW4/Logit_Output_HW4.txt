Last login: Wed Aug 28 11:27:27 on ttys003
-bash: PATH: command not found
Chads-MacBook-Air:r_work caboe$ r

R version 3.0.1 (2013-05-16) -- "Good Sport"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin10.8.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> #source -- http://www.umass.edu/statdata/statdata/stat-survival.html ; data = whas500.dat
> 
> ## Load the necessary libraries in order to plot the Survival Analysis charts ##
> library(survival)
Loading required package: splines
library(KMsurv)
# Load the modified data set as described in analysis outline #
data <- read.table("heart_attack_mod1.txt", h=T)

# Display the first 6 rows in the data set in order to verfiy properly imported ##
head(data)
# Create two emptey vectors that will be used to store the overall analysis resutls for both Total Errors
# and the Overall Error Rate this correpsonds to
results.err.total <- c()
cumulative.err.rates <- c()

## Create the Train/Test Split ##
logit.nfold <- function(seed, n.folds) {
	set.seed(seed) #Allow the user to set the seed 
	N <- nrow(data) # Create a variable to hold the number of rows in the dataset, in this case 460
	randomized <- sample(1:N) # Create a randomized range of numbers equal to the number of rows in the dataset
	randomized #Verify randomized range properly created and in order to verify seed properly set

	fold <- 1 # Create the variable to be used in tracking the fold analyses
	range <- (N / n.folds)  # Set the range equal to the number of dataset 
Attaching package: ‘survival’

The following object is masked _by_ ‘.GlobalEnv’:

    kidney

> library(KMsurv)
> # Load the modified data set as described in analysis outline #
> data <- read.table("heart_attack_mod1.txt", h=T)
> 
> # Display the first 6 rows in the data set in order to verfiy properly imported ##
> head(data)
# Create two emptey vectors that will be used to store the overall analysis resutls for both Total Errors
# and the Overall Error Rate this correpsonds to
results.err.total <- c()
cumulative.err.rates <- c()

## Create the Train/Test Split ##
logit.nfold <- function(seed, n.folds) {
	set.seed(seed) #Allow the user to set the seed 
	N <- nrow(data) # Create a variable to hold the number of rows in the dataset, in this case 460
	randomized <- sample(1:N) # Create a randomized range of numbers equal to the number of rows in the dataset
	randomized #Verify randomized range properly created and in order to verify seed properly set

	fold <- 1 # Create the variable to be used in tracking the fold analyses
	range <- (N / n.folds)  # Set the range equal to the number of dataset rows divivded by the number of folds
	increment.by <- (1:range) # Increment the folds by the range in the test splits

	time.train0 <- rep(0, N - range) # Create a vector of 0s equal to the length of the train split data set
	  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
> # Create two emptey vectors that will be used to store the overall analysis resutls for both Total Errors
> # and the Overall Error Rate this correpsonds to
> results.err.total <- c()
> cumulative.err.rates <- c()
> 
> ## Create the Train/Test Split ##
> logit.nfold <- function(seed, n.folds) {
+ set.seed(seed) #Allow the user to set the seed 
+ N <- nrow(data) # Create a variable to hold the number of rows in the dataset, in this case 460
+ randomized <- sample(1:N) # Create a randomized range of numbers equal to the number of rows in the dataset
+ randomized #Verify randomized range properly created and in order to verify seed properly set
+ 
+ fold <- 1 # Create the variable to be used in tracking the fold analyses
+ range <- (N / n.folds)  # Set the range equal to the number of dataset rows divivded by the number of folds
+ increment.by <- (1:range) # Increment the folds by the range in the test splits
+ 
+ time.train0 <- rep(0, N - range) # Create a vector of 0s equal to the length of the train split data set
+ time.test0 <- rep(0, range) # Create a vector of 0s equal to the length of the test split data set
+ # These will be used in the function to plot the survival probabilty over time+ # Iterate over the Train/Test splits for the Logistic Analysis 
+ for (each in 1:n.folds) {
+ train.data <- data[-randomized[increment.by], ]
+ test.data <- data[randomized[increment.by], ]
+ 
+ print (head(train.data))
+ print (head(test.data))
+ 
+ cat('\n', 'Fold ', fold,' Cross Validation Below', '\n', sep = "")
+ 
+ # Create a model where survival is a function of age, body mass index, congestive heart failure,
+ # wether this was the patients first heart attack (MIORD) where 0 = first, 1 = not first, and length of follow-up
+ # since the time of the most recent heart attack 
+ logit.fit <- glm(fstat ~ age + bmi + chf + miord + lenfol, family='binomial', data=train.data)
+ cat('\n', 'Summary of fold ', fold,' Training Analysis Below', '\n', sep = "")+ # Pass the Survival Fit function the start time of 0, the duration equal to the patient's Length of Follow-Up, and set 
+ # the event as equal to the patients mortality  (0=life, 1=death)
+ my.train.fit <- survfit(Surv(time.train0, train.data$lenfol, train.data$fstat) ~ 1)
+ print (summary(logit.fit))
+ xaxis <- "Length of Follow-Up (in days)"
+ yaxis <-  "Surival Probability"
+ # PLot the Survival Probabiliyt of the patients as a function of time 
+ train.plot <- plot(my.train.fit, xlab = xaxis , ylab= yaxis, main="Train Fold Survival Analysis")
+ train.plot
+ 
+ ## Predict out of sample data error using the Generaliztion error as proxy ##
+ ## Create a new data frame comprised of the test data columns listed below ##
+ new.data <- with(test.data, data.frame(age=age, bmi=bmi, chf=chf, miord=miord, lenfol=lenfol))
+ cat('\n', 'Fold ', fold,' Test Data Frame', '\n', sep = "")
+ print (new.data)
+ ## Run the Trained Model against the new test data and add column to the new.data frame
+ new.data$mort.prob <- predict(logit.fit, newdata=new.data, type='response')
+ ## Round the predictions to the nearest whole 0,1 and add to the new.data frame
+ new.data$mort.round <- round(new.data$mort.prob)
+ # Juxtapose the test data sets known survival statistics in order to compare to the model's predictions
+ new.data$actual <- test.data$fstat
+ cat('\n', 'Fold ', fold,' Test Data Set Cross Validation Below', '\n', sep = "")
+ print(new.data)
+ cat('\n', 'Fold ', fold,' Confusion Matrix of Predicted versus Acutal Mortality', '\n', sep = "")
+ # Create a confusion matrix that more effeciently displays the (in)accuracy of the model's predictions
+ xtable <- xtabs(~new.data$actual + new.data$mort.round, data=new.data)
+ print (xtable)
+ # Pass the Survival Fit function the start time of 0, the duration equal to the patient's Length of Follow-Up, and set 
+ # the event as equal to the patients mortality  (0=life, 1=death)
+ my.test.fit <- survfit(Surv(time.test0, new.data$lenfol, new.data$mort.round) ~ 1)
+ print (summary(logit.fit))
+ xaxis <- "Length of Follow-Up (in days)"
+ yaxis <-  "Surival Probability"
+ # PLot the Survival Probabiliyt of the patients as a function of time 
+ test.plot <- plot(my.test.fit, xlab = xaxis , ylab= yaxis, main="Test Fold Survival Analysis")
+ test.plot
+ # Calculate the Total Numer of Errors for the Test Fold ##
+ gen.err.total <- sum(as.numeric(new.data$actual != new.data$mort.round))
+ cat('\n', "The Total number of Generaliztion Errors for fold ",fold,' is:', '\n', sep = "")
+ print(gen.err.total)
+ # Store this data in a vector for further analysis once the function has completed
+ results.err.total <- append(results.err.total, gen.err.total)
+ # Convert the Number of Errors to the Error Rate for the Test Fold 
+ gen.err.rate <- gen.err.total / length(new.data$actual)
+ cat('\n', "the total Generalization Error Rate for fold ",fold,' is:',  '\n', sep = "")
+ print (gen.err.rate)
+ # Store this data in a vector for further analysis once the function has completed
+ cumulative.err.rates <- append(cumulative.err.rates, gen.err.rate)
+ cumulative.err.rates
+ # Increment the range in order to complete the following TRAIN/TEST analysis
+ increment.by <- increment.by + range
+ fold <- fold + 1 
+ #ggplot(new.data, aes(x=age, y=actual)) + geom_point()
+ #ggplot(new.data, aes(x=age, y=a) + geom_line() 
+ }
+ # Print out the Generalization Error Totals, Rates and Average Generalization Error Rate ##
+ cat('\n', "the Total Number of Generalization Errors for this analysis is:",  '\n', sep = "")
+ total.num.err <- sum(results.err.total)
+ print (total.num.err)
+ cat('\n', "Below are the Generaliztion Errors for each analysis:",  '\n', sep = "")
+ print (cumulative.err.rates)
+ cat('\n', "the Overall Generalization Error Rate for this analyis is:",  '\n', sep = "")
+ total.err.rate <- sum(cumulative.err.rates) / length(cumulative.err.rates)
+ print (total.err.rate)
+ }
> 
> logit.nfold(08112013, 10)
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
7  8  55      0 91   147     95 27.11609   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
7   1/11/97 1/15/97  2/15/01   4     0   1496     1
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
243 266  88      1  98   177     63 17.68003   1   0   0   0   0     1      0
79   85  73      1  91   160     70 27.34205   1   0   0   0   0     1      0
459 499  67      0  59   112     62 27.40905   1   0   0   0   0     0      1
221 240  90      0  60   163     99 22.80757   0   0   0   0   0     0      1
435 475  82      0  35   143     58 27.92796   1   0   0   1   1     0      0
452 492  93      0 116   198     21 23.02361   1   0   0   1   0     0      0
    year admitdate  disdate    fdate los dstat lenfol fstat
243    2  12/13/99 12/16/99   1/1/01   3     0    385     1
79     1   2/15/97  2/18/97 12/31/02   3     0   2145     0
459    3   7/17/01  7/18/01 12/31/02   1     0    532     0
221    2   8/18/99  8/23/99 12/31/02   5     0   1231     0
435    3   10/7/01 10/12/01 12/31/02   5     0    450     0
452    3  11/23/01 11/27/01  12/7/01   4     0     14     1

Fold 1 Cross Validation Below

Summary of fold 1 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1928  -0.6495  -0.2954   0.6000   3.2525  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.9458180  1.2994236  -3.037 0.002393 ** 
age          0.0713154  0.0119896   5.948 2.71e-09 ***
bmi         -0.0232618  0.0274105  -0.849 0.396080    
chf          1.0808109  0.2986546   3.619 0.000296 ***
miord        0.3926928  0.2805900   1.400 0.161656    
lenfol      -0.0017016  0.0002429  -7.004 2.49e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 548.53  on 413  degrees of freedom
Residual deviance: 346.60  on 408  degrees of freedom
AIC: 358.6

Number of Fisher Scoring iterations: 5


Fold 1 Test Data Frame
   age      bmi chf miord lenfol
1   88 17.68003   0     1    385
2   73 27.34205   0     1   2145
3   67 27.40905   0     0    532
4   90 22.80757   0     0   1231
5   82 27.92796   1     0    450
6   93 23.02361   1     0     14
7   70 25.80243   0     1   1319
8   80 22.45955   1     0   2009
9   48 35.08359   0     0   2192
10  82 23.17285   1     0    535
11  48 31.58373   0     0   1048
12  76 36.18801   1     1     91
13  50 24.63218   0     0   2123
14  75 24.40797   1     1    718
15  88 27.43554   1     0    920
16  52 31.45634   0     0    371
17  81 28.28139   1     0     37
18  80 26.95145   0     0     42
19  63 30.84949   1     0   2048
20  70 31.88578   0     0   1338
21  82 25.82748   1     0   2114
22  90 17.21832   0     1     64
23  69 30.96292   0     1    550
24  82 18.60004   1     0    359
25  76 33.45110   0     0    570
26  68 18.29036   1     1     32
27  52 30.27341   0     0   1248
28  83 25.54051   0     1   2178
29  81 24.02195   0     0     83
30  68 40.35132   0     0   1931
31  89 22.26424   1     0    542
32  65 27.36909   0     1   1506
33  52 26.58153   1     0   1381
34  89 18.60707   1     1     20
35  75 28.69720   1     0   1671
36  80 22.88965   0     1    376
37  65 29.41463   0     0   1163
38  75 21.25718   0     1    289
39  80 22.44662   1     1   2126
40  69 24.21079   0     0   1256
41  53 24.21079   0     0   1934
42  76 25.84858   1     0    397
43  44 31.93060   0     0   1390
44  69 20.67426   0     0   1887
45  76 28.12326   0     0    614
46  53 31.63544   0     1   1920

Fold 1 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol   mort.prob mort.round actual
1   88 17.68003   0     1    385 0.839731541          1      1
2   73 27.34205   0     1   2145 0.067037072          0      0
3   67 27.40905   0     0    532 0.329480195          0      0
4   90 22.80757   0     0   1231 0.461903218          0      0
5   82 27.92796   1     0    450 0.827422245          1      0
6   93 23.02361   1     0     14 0.961131609          1      1
7   70 25.80243   0     1   1319 0.196912108          0      0
8   80 22.45955   1     0   2009 0.249590597          0      0
9   48 35.08359   0     0   2192 0.006250926          0      0
10  82 23.17285   1     0    535 0.822509225          1      1
11  48 31.58373   0     0   1048 0.045621574          0      1
12  76 36.18801   1     1     91 0.875556623          1      1
13  50 24.63218   0     0   2123 0.010296577          0      0
14  75 24.40797   1     1    718 0.747778137          1      1
15  88 27.43554   1     0    920 0.769776350          1      1
16  52 31.45634   0     0    371 0.167918383          0      0
17  81 28.28139   1     0     37 0.899411516          1      1
18  80 26.95145   0     0     42 0.742882592          1      1
19  63 30.84949   1     0   2048 0.070785430          0      0
20  70 31.88578   0     0   1338 0.122148516          0      0
21  82 25.82748   1     0   2114 0.228785591          0      0
22  90 17.21832   0     1     64 0.913396159          1      1
23  69 30.96292   0     1    550 0.428368177          0      0
24  82 18.60004   1     0    359 0.874275135          1      1
25  76 33.45110   0     0    570 0.431947638          0      0
26  68 18.29036   1     1     32 0.869575755          1      1
27  52 30.27341   0     0   1248 0.044563066          0      0
28  83 25.54051   0     1   2178 0.126285027          0      0
29  81 24.02195   0     0     83 0.755967897          1      1
30  68 40.35132   0     0   1931 0.034862482          0      0
31  89 22.26424   1     0    542 0.885123864          1      1
32  65 27.36909   0     1   1506 0.107462051          0      1
33  52 26.58153   1     0   1381 0.106701141          0      0
34  89 18.60707   1     1     20 0.967950147          1      1
35  75 28.69720   1     0   1671 0.263603582          0      1
36  80 22.88965   0     1    376 0.727076219          1      0
37  65 29.41463   0     0   1163 0.122008262          0      0
38  75 21.25718   0     1    289 0.691955558          1      1
39  80 22.44662   1     1   2126 0.287635856          0      0
40  69 24.21079   0     0   1256 0.151165638          0      0
41  53 24.21079   0     0   1934 0.017632222          0      0
42  76 25.84858   1     0    397 0.782131523          1      1
43  44 31.93060   0     0   1390 0.019532176          0      0
44  69 20.67426   0     0   1887 0.061980591          0      0
45  76 28.12326   0     0    614 0.444024138          0      1
46  53 31.63544   0     1   1920 0.022391397          0      0

Fold 1 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 24  2
              1  4 16

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1928  -0.6495  -0.2954   0.6000   3.2525  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.9458180  1.2994236  -3.037 0.002393 ** 
age          0.0713154  0.0119896   5.948 2.71e-09 ***
bmi         -0.0232618  0.0274105  -0.849 0.396080    
chf          1.0808109  0.2986546   3.619 0.000296 ***
miord        0.3926928  0.2805900   1.400 0.161656    
lenfol      -0.0017016  0.0002429  -7.004 2.49e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 548.53  on 413  degrees of freedom
Residual deviance: 346.60  on 408  degrees of freedom
AIC: 358.6

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 1 is:
[1] 6

the total Generalization Error Rate for fold 1 is:
[1] 0.1304348
   id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1   1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
5   5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6   7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
7   8  55      0 91   147     95 27.11609   1   0   0   0   0     0      1    1
8   9  88      1 63   209    100 27.43554   1   0   0   1   0     0      0    1
10 11  48      0 95   160    110 33.45110   0   0   0   0   0     0      1    1
   admitdate disdate    fdate los dstat lenfol fstat
1    1/13/97 1/18/97 12/31/02   5     0   2178     0
5     3/1/97  3/7/97 12/31/02   6     0   2131     0
6    3/10/97 3/15/97 12/31/02   5     0   2122     0
7    1/11/97 1/15/97  2/15/01   4     0   1496     1
8   12/31/96  1/4/97   7/9/99   4     0    920     1
10   1/18/97 1/23/97 12/31/02   5     0   2173     0
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
425 464  47      0  74   178    110 26.95468   0   0   0   0   0     0      1
184 199  81      0 150   170    104 21.95112   1   0   0   0   0     0      0
14   15  67      0  93   138     84 26.31269   0   0   0   0   0     1      0
327 356  50      0  56   100     60 28.79666   1   0   0   0   0     1      0
409 445  49      0  60   180    100 27.05769   0   0   0   0   0     0      1
229 248  79      0  79   111     51 26.38699   0   0   0   0   0     1      0
    year admitdate  disdate    fdate los dstat lenfol fstat
425    3  10/30/01  11/3/01 12/31/02   4     0    427     0
184    2   6/14/99  6/16/99  3/29/01   2     0    654     1
14     1   1/25/97  1/29/97 12/31/02   4     0   2166     0
327    3   6/29/01   7/3/01 12/31/02   4     0    550     0
409    3   12/6/01 12/10/01 12/31/02   4     0    390     0
229    2  10/17/99 10/21/99 11/26/02   4     0   1136     1

Fold 2 Cross Validation Below

Summary of fold 2 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1314  -0.6356  -0.2874   0.5950   3.2585  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.3810422  1.3244243  -2.553 0.010685 *  
age          0.0646922  0.0120078   5.388 7.14e-08 ***
bmi         -0.0255682  0.0275968  -0.926 0.354191    
chf          1.0082024  0.2953943   3.413 0.000642 ***
miord        0.4223737  0.2816174   1.500 0.133663    
lenfol      -0.0017773  0.0002419  -7.348 2.01e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 548.53  on 413  degrees of freedom
Residual deviance: 342.75  on 408  degrees of freedom
AIC: 354.75

Number of Fisher Scoring iterations: 5


Fold 2 Test Data Frame
   age      bmi chf miord lenfol
1   47 26.95468   0     0    427
2   81 21.95112   0     0    654
3   67 26.31269   0     1   2166
4   50 28.79666   0     1    550
5   49 27.05769   0     0    390
6   79 26.38699   0     1   1136
7   80 28.35006   0     1   1836
8   65 16.99342   1     1    226
9   76 29.40577   1     0    704
10  80 23.10125   0     0   1308
11  69 29.53503   0     0   1942
12  73 25.46070   0     0    113
13  71 25.19375   0     0     46
14  88 30.66700   0     0   2160
15  66 27.39631   0     0    521
16  86 15.54681   0     0     19
17  63 24.43321   0     0    403
18  59 28.03399   0     0   1377
19  57 21.81350   1     1    321
20  58 23.48035   0     0   1106
21  49 24.02398   0     0   2172
22  50 24.90308   0     0    433
23  70 26.63187   1     0    297
24  82 23.41166   0     0    506
25  73 25.13029   1     1   1277
26  59 31.74353   1     0    274
27  53 31.45634   0     1    532
28  68 25.17922   0     0   2066
29  54 25.54448   0     0   2175
30  76 25.44908   0     0   1199
31  79 19.13147   1     1    101
32  74 22.48625   1     1    354
33  81 27.46758   0     0     33
34  56 20.08382   0     1   1298
35  61 30.84949   0     0    511
36  59 29.53045   0     0    442
37  84 24.44576   1     1    632
38  66 22.46532   1     1     53
39  87 14.84283   0     1   2123
40  40 38.35497   0     0    376
41  70 22.14290   0     0   2190
42  63 28.12934   0     0   1458
43  83 19.65076   0     1   1174
44  84 23.56005   0     1   1579
45  74 26.33420   0     1    516
46  61 25.46070   1     0    714

Fold 2 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol   mort.prob mort.round actual
1   47 26.95468   0     0    427 0.143244876          0      0
2   81 21.95112   0     0    654 0.533804384          1      1
3   67 26.31269   0     1   2166 0.041222493          0      0
4   50 28.79666   0     1    550 0.191878608          0      0
5   49 27.05769   0     0    390 0.168529332          0      0
6   79 26.38699   0     1   1136 0.367801895          0      1
7   80 28.35006   0     1   1836 0.145385400          0      0
8   65 16.99342   1     1    226 0.805082087          1      1
9   76 29.40577   1     0    704 0.631975006          1      1
10  80 23.10125   0     0   1308 0.245821483          0      0
11  69 29.53503   0     0   1942 0.042130464          0      0
12  73 25.46070   0     0    113 0.620028179          1      1
13  71 25.19375   0     0     46 0.619207885          1      1
14  88 30.66700   0     0   2160 0.090201158          0      1
15  66 27.39631   0     0    521 0.323484882          0      0
16  86 15.54681   0     0     19 0.852105590          1      1
17  63 24.43321   0     0    403 0.343801843          0      0
18  59 28.03399   0     0   1377 0.061323168          0      1
19  57 21.81350   1     1    321 0.647654432          1      1
20  58 23.48035   0     0   1106 0.100206587          0      0
21  49 24.02398   0     0   2172 0.009142351          0      0
22  50 24.90308   0     0    433 0.174692601          0      0
23  70 26.63187   1     0    297 0.720476675          1      1
24  82 23.41166   0     0    506 0.604873184          1      0
25  73 25.13029   1     1   1277 0.465038259          0      0
26  59 31.74353   1     0    274 0.536284885          1      1
27  53 31.45634   0     1    532 0.217586847          0      0
28  68 25.17922   0     0   2066 0.035652015          0      0
29  54 25.54448   0     0   2175 0.012051984          0      0
30  76 25.44908   0     0   1199 0.223376461          0      0
31  79 19.13147   1     1    101 0.923547420          1      1
32  74 22.48625   1     1    354 0.836533722          1      1
33  81 27.46758   0     0     33 0.749899469          1      1
34  56 20.08382   0     1   1298 0.103740377          0      0
35  61 30.84949   0     0    511 0.243832393          0      0
36  59 29.53045   0     0    442 0.248840158          0      0
37  84 24.44576   1     1    632 0.850101022          1      1
38  66 22.46532   1     1     53 0.838975187          1      1
39  87 14.84283   0     1   2123 0.184952967          0      0
40  40 38.35497   0     0    376 0.080004574          0      0
41  70 22.14290   0     0   2190 0.035195302          0      0
42  63 28.12934   0     0   1458 0.068119352          0      0
43  83 19.65076   0     1   1174 0.455569157          0      1
44  84 23.56005   0     1   1579 0.282264233          0      1
45  74 26.33420   0     1    516 0.559258026          1      0
46  61 25.46070   1     0    714 0.414210039          0      1

Fold 2 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 24  2
              1  6 14

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1314  -0.6356  -0.2874   0.5950   3.2585  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.3810422  1.3244243  -2.553 0.010685 *  
age          0.0646922  0.0120078   5.388 7.14e-08 ***
bmi         -0.0255682  0.0275968  -0.926 0.354191    
chf          1.0082024  0.2953943   3.413 0.000642 ***
miord        0.4223737  0.2816174   1.500 0.133663    
lenfol      -0.0017773  0.0002419  -7.348 2.01e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 548.53  on 413  degrees of freedom
Residual deviance: 342.75  on 408  degrees of freedom
AIC: 354.75

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 2 is:
[1] 8

the total Generalization Error Rate for fold 2 is:
[1] 0.173913
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
7  8  55      0 91   147     95 27.11609   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
7   1/11/97 1/15/97  2/15/01   4     0   1496     1
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
181 196  80      1  89   166     68 28.62249   1   0   0   0   0     1      0
24   25  69      0  74   144     87 30.02138   1   0   0   0   0     0      0
431 471  58      0  70   155     77 27.05769   0   0   0   0   0     1      0
287 310  90      1  84    90     50 18.89496   0   1   0   1   0     0      0
88   95  79      0 100   148     79 23.72658   0   1   0   0   0     0      1
248 271  77      0 104   128     77 21.76927   0   0   0   0   0     0      0
    year admitdate  disdate    fdate los dstat lenfol fstat
181    2    5/8/99  5/13/99 12/31/02   5     0   1333     0
24     1   5/23/97  5/29/97 12/31/02   6     0   2048     0
431    3  10/11/01 10/17/01 12/31/02   6     0    446     0
287    2    6/5/99  6/17/99  6/19/99  12     0     14     1
88     1   9/15/97  9/22/97   3/6/00   7     0    903     1
248    2   11/6/99 11/11/99 12/31/02   5     0   1151     0

Fold 3 Cross Validation Below

Summary of fold 3 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2426  -0.6304  -0.2660   0.5762   3.3158  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7998881  1.3215127  -2.875 0.004035 ** 
age          0.0713428  0.0121373   5.878 4.15e-09 ***
bmi         -0.0243749  0.0281579  -0.866 0.386681    
chf          1.0503422  0.2951772   3.558 0.000373 ***
miord        0.4912469  0.2828888   1.737 0.082469 .  
lenfol      -0.0018360  0.0002435  -7.542 4.65e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 554.20  on 413  degrees of freedom
Residual deviance: 342.03  on 408  degrees of freedom
AIC: 354.03

Number of Fisher Scoring iterations: 5


Fold 3 Test Data Frame
   age      bmi chf miord lenfol
1   80 28.62249   0     1   1333
2   69 30.02138   0     0   2048
3   58 27.05769   0     1    446
4   90 18.89496   1     0     14
5   79 23.72658   0     0    903
6   77 21.76927   0     0   1151
7   82 25.39243   0     1    421
8   57 31.19381   0     0   2100
9   67 39.30151   0     0   1858
10  79 25.82484   0     1     17
11  70 24.41255   0     0   2131
12  92 13.04546   0     0      6
13  76 24.26862   0     0    662
14  50 35.26257   0     0    459
15  61 24.44576   0     0   1388
16  48 26.15268   0     1   1400
17  57 42.13576   0     0    725
18  58 29.75840   0     0    449
19  65 24.07105   0     0    507
20  69 25.95993   0     0   1994
21  75 15.58860   0     0    537
22  81 24.74646   1     0     57
23  63 40.78750   1     0   1140
24  72 25.40431   0     1    626
25  59 27.46412   0     1    458
26  65 30.22827   1     1    473
27  56 25.94995   0     0   1320
28  86 24.78423   0     0     33
29  72 25.82748   0     1   2113
30  68 34.97161   1     0   1314
31  85 26.13850   0     0     18
32  85 25.69714   1     1    535
33  72 29.38736   0     0    523
34  58 28.56874   1     0   2057
35  87 28.43344   0     0     97
36  32 39.93835   0     1   1577
37  58 31.05819   0     1   1114
38  41 27.26234   0     0   2084
39  92 24.75240   1     1     31
40  55 25.10478   0     0   1232
41  53 26.68840   0     0   1253
42  67 30.41010   1     0   2350
43  88 21.78861   0     0    137
44  33 20.92089   0     0   1353
45  57 29.19369   0     0   2083
46  43 31.61786   0     0   1161

Fold 3 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol   mort.prob mort.round actual
1   80 28.62249   0     1   1333 0.321629045          0      0
2   69 30.02138   0     0   2048 0.033273332          0      0
3   58 27.05769   0     1    446 0.343180774          0      0
4   90 18.89496   1     0     14 0.960267251          1      1
5   79 23.72658   0     0    903 0.401297373          0      1
6   77 21.76927   0     0   1151 0.278810497          0      0
7   82 25.39243   0     1    421 0.759431625          1      0
8   57 31.19381   0     0   2100 0.012750864          0      0
9   67 39.30151   0     0   1858 0.032634533          0      0
10  79 25.82484   0     1     17 0.841141586          1      1
11  70 24.41255   0     0   2131 0.035111259          0      0
12  92 13.04546   0     0      6 0.919431551          1      1
13  76 24.26862   0     0    662 0.453925132          0      0
14  50 35.26257   0     0    459 0.126197948          0      0
15  61 24.44576   0     0   1388 0.069640281          0      0
16  48 26.15268   0     1   1400 0.043435320          0      0
17  57 42.13576   0     0    725 0.109924194          0      0
18  58 29.75840   0     0    449 0.229394014          0      0
19  65 24.07105   0     0    507 0.336217422          0      0
20  69 25.95993   0     0   1994 0.040271079          0      0
21  75 15.58860   0     0    537 0.546096210          1      1
22  81 24.74646   1     0     57 0.910631696          1      1
23  63 40.78750   1     0   1140 0.207148798          0      0
24  72 25.40431   0     1    626 0.514862149          1      0
25  59 27.46412   0     1    458 0.352116784          0      0
26  65 30.22827   1     1    473 0.684328321          1      1
27  56 25.94995   0     0   1320 0.054127894          0      0
28  86 24.78423   0     0     33 0.841694144          1      1
29  72 25.82748   0     1   2113 0.064103911          0      0
30  68 34.97161   1     0   1314 0.238088392          0      0
31  85 26.13850   0     0     18 0.831188642          1      1
32  85 25.69714   1     1    535 0.899998128          1      0
33  72 29.38736   0     0    523 0.415868230          0      0
34  58 28.56874   1     0   2057 0.043742631          0      0
35  87 28.43344   0     0     97 0.822849907          1      1
36  32 39.93835   0     1   1577 0.007431570          0      1
37  58 31.05819   0     1   1114 0.122054195          0      0
38  41 27.26234   0     0   2084 0.004652894          0      0
39  92 24.75240   1     1     31 0.974543087          1      1
40  55 25.10478   0     0   1232 0.060090580          0      0
41  53 26.68840   0     0   1253 0.048810268          0      0
42  67 30.41010   1     0   2350 0.046289119          0      1
43  88 21.78861   0     0    137 0.844965227          1      1
44  33 20.92089   0     0   1353 0.011662487          0      0
45  57 29.19369   0     0   2083 0.013797717          0      0
46  43 31.61786   0     0   1161 0.025719678          0      0

Fold 3 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 29  3
              1  3 11

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2426  -0.6304  -0.2660   0.5762   3.3158  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7998881  1.3215127  -2.875 0.004035 ** 
age          0.0713428  0.0121373   5.878 4.15e-09 ***
bmi         -0.0243749  0.0281579  -0.866 0.386681    
chf          1.0503422  0.2951772   3.558 0.000373 ***
miord        0.4912469  0.2828888   1.737 0.082469 .  
lenfol      -0.0018360  0.0002435  -7.542 4.65e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 554.20  on 413  degrees of freedom
Residual deviance: 342.03  on 408  degrees of freedom
AIC: 354.03

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 3 is:
[1] 6

the total Generalization Error Rate for fold 3 is:
[1] 0.1304348
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
226 245  97      1  69   198     55 19.33474   1   0   0   1   0     0      0
293 316  80      1  84   170     90 19.33474   1   0   0   1   0     0      0
387 417  86      0 108   151     72 28.34291   1   0   0   0   0     1      0
416 452  85      1  96   190    100 21.39972   1   0   0   1   0     1      0
240 263  85      1  73   160     70 31.75539   1   0   0   0   0     1      0
230 249  80      0  91   164     98 27.76293   1   0   0   0   0     1      0
    year admitdate  disdate    fdate los dstat lenfol fstat
226    2    9/7/99  9/10/99  11/2/02   3     0   1152     1
293    2   7/30/99   8/2/99 12/12/99   3     0    135     1
387    3    9/9/01  9/15/01 11/10/01   6     0     62     1
416    3  10/31/01  11/9/01 12/27/01   9     0     57     1
240    2  12/10/99 12/15/99 12/31/02   5     0   1117     0
230    2   10/6/99 10/13/99 12/31/02   7     0   1182     0

Fold 4 Cross Validation Below

Summary of fold 4 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2371  -0.6440  -0.2974   0.6048   3.2222  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.8201169  1.3274992  -2.878 0.004006 ** 
age          0.0702665  0.0121545   5.781 7.42e-09 ***
bmi         -0.0271622  0.0282695  -0.961 0.336636    
chf          1.1264544  0.3002140   3.752 0.000175 ***
miord        0.4740595  0.2801328   1.692 0.090595 .  
lenfol      -0.0016330  0.0002352  -6.944 3.81e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 550.51  on 413  degrees of freedom
Residual deviance: 345.64  on 408  degrees of freedom
AIC: 357.64

Number of Fisher Scoring iterations: 5


Fold 4 Test Data Frame
   age      bmi chf miord lenfol
1   97 19.33474   1     0   1152
2   80 19.33474   1     0    135
3   86 28.34291   0     1     62
4   85 21.39972   1     1     57
5   85 31.75539   0     1   1117
6   80 27.76293   0     1   1182
7   81 18.90242   1     0   1914
8   75 37.88828   0     0    392
9   81 20.83088   0     0    117
10  83 19.05323   1     1    445
11  58 30.23193   0     1   1265
12  73 22.67395   0     0   1933
13  73 19.72534   1     0   1165
14  69 23.80672   1     1   1548
15  65 26.95468   0     0   1449
16  55 34.48526   0     0   1191
17  85 27.45762   0     1   1302
18  59 25.12788   1     0    412
19  68 36.71647   0     0    510
20  65 23.02862   1     1    328
21  67 23.36757   0     1   1977
22  61 25.80243   0     0   1106
23  59 27.26068   0     0   1858
24  63 21.25718   1     0   1955
25  90 21.76553   1     0    134
26  73 22.65552   1     0     61
27  79 21.52290   1     0    187
28  80 27.43554   0     1   1274
29  98 19.48575   0     0    259
30  58 32.28350   0     1    478
31  58 24.96656   0     0   1366
32  32 30.55383   0     0    426
33  80 36.02333   0     0   1993
34  66 31.24806   1     0   1174
35  85 28.34291   0     1   2132
36  47 34.45710   0     0    145
37  54 30.10600   0     1   1245
38  69 28.64898   0     0   1272
39  84 25.31924   1     0    371
40  68 28.40733   0     0   1098
41  82 21.63993   0     0    524
42  81 28.69720   0     0     88
43  80 28.55371   0     0    116
44  83 22.77751   1     0    287
45  81 27.21937   0     0    269
46  48 31.38134   0     0    466

Fold 4 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol  mort.prob mort.round actual
1   97 19.33474   1     0   1152 0.84759136          1      1
2   80 19.33474   1     0    135 0.89862459          1      1
3   86 28.34291   0     1     62 0.86125633          1      1
4   85 21.39972   1     1     57 0.95600593          1      1
5   85 31.75539   0     1   1117 0.48500980          0      0
6   80 27.76293   0     1   1182 0.39914941          0      0
7   81 18.90242   1     0   1914 0.34501749          0      0
8   75 37.88828   0     0    392 0.44537344          0      1
9   81 20.83088   0     0    117 0.75298606          1      1
10  83 19.05323   1     1    445 0.91437934          1      0
11  58 30.23193   0     1   1265 0.10363480          0      0
12  73 22.67395   0     0   1933 0.07848802          0      0
13  73 19.72534   1     0   1165 0.49939951          0      1
14  69 23.80672   1     1   1548 0.36686345          0      1
15  65 26.95468   0     0   1449 0.08697696          0      0
16  55 34.48526   0     0   1191 0.05535596          0      0
17  85 27.45762   0     1   1302 0.43897043          0      0
18  59 25.12788   1     0    412 0.52416850          1      0
19  68 36.71647   0     0    510 0.29481556          0      0
20  65 23.02862   1     1    328 0.76613214          1      1
21  67 23.36757   0     1   1977 0.07576705          0      0
22  61 25.80243   0     0   1106 0.11498765          0      0
23  59 27.26068   0     0   1858 0.03080125          0      0
24  63 21.25718   1     0   1955 0.11540077          0      0
25  90 21.76553   1     0    134 0.94376339          1      1
26  73 22.65552   1     0     61 0.84823302          1      1
27  79 21.52290   1     0    187 0.87733355          1      1
28  80 27.43554   0     1   1274 0.36578291          0      0
29  98 19.48575   0     0    259 0.89223608          1      1
30  58 32.28350   0     1    478 0.28332032          0      0
31  58 24.96656   0     0   1366 0.06577699          0      0
32  32 30.55383   0     0    426 0.04322521          0      0
33  80 36.02333   0     0   1993 0.08078109          0      0
34  66 31.24806   1     0   1174 0.30535043          0      0
35  85 28.34291   0     1   2132 0.16455015          0      0
36  47 34.45710   0     0    145 0.15573607          0      1
37  54 30.10600   0     1   1245 0.08298523          0      0
38  69 28.64898   0     0   1272 0.13859168          0      0
39  84 25.31924   1     0    371 0.87159853          1      0
40  68 28.40733   0     0   1098 0.16706089          0      0
41  82 21.63993   0     0    524 0.62205344          1      0
42  81 28.69720   0     0     88 0.72077140          1      1
43  80 28.55371   0     0    116 0.69766408          1      1
44  83 22.77751   1     0    287 0.88605966          1      1
45  81 27.21937   0     0    269 0.66660384          1      1
46  48 31.38134   0     0    466 0.11297813          0      0

Fold 4 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 24  4
              1  4 14

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2371  -0.6440  -0.2974   0.6048   3.2222  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.8201169  1.3274992  -2.878 0.004006 ** 
age          0.0702665  0.0121545   5.781 7.42e-09 ***
bmi         -0.0271622  0.0282695  -0.961 0.336636    
chf          1.1264544  0.3002140   3.752 0.000175 ***
miord        0.4740595  0.2801328   1.692 0.090595 .  
lenfol      -0.0016330  0.0002352  -6.944 3.81e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 550.51  on 413  degrees of freedom
Residual deviance: 345.64  on 408  degrees of freedom
AIC: 357.64

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 4 is:
[1] 8

the total Generalization Error Rate for fold 4 is:
[1] 0.173913
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
231 251 102      0  89   118     60 22.27393   0   0   0   1   0     0      0
51   54  83      0 107   136     59 26.38699   1   0   0   1   0     0      0
265 288  90      0  58   133     51 27.25264   1   1   0   1   0     1      0
37   40  65      0  68   174     90 27.31990   1   0   0   0   0     0      0
16   17  70      1  95   127     53 23.67519   1   0   0   1   0     1      0
332 361  81      1  96   160     72 29.18062   1   0   0   0   0     1      0
    year admitdate  disdate    fdate los dstat lenfol fstat
231    2  10/25/99 10/28/99  4/11/00   3     0    169     1
51     1   5/27/97   6/2/97   5/5/98   6     0    343     1
265    2  12/29/98   1/1/99   5/7/99   3     0    129     1
37     1    5/6/97   5/9/97 12/31/02   3     0   2065     0
16     1  12/20/96   1/2/97  6/13/99  13     0    905     1
332    3   6/29/01   7/4/01 12/31/02   5     0    550     0

Fold 5 Cross Validation Below

Summary of fold 5 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1824  -0.6667  -0.3007   0.6237   3.2328  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.0972131  1.2958660  -2.390 0.016845 *  
age          0.0639678  0.0117767   5.432 5.58e-08 ***
bmi         -0.0332403  0.0274574  -1.211 0.226044    
chf          1.0828334  0.2898496   3.736 0.000187 ***
miord        0.3936459  0.2754489   1.429 0.152974    
lenfol      -0.0017322  0.0002377  -7.287 3.17e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 556.76  on 413  degrees of freedom
Residual deviance: 355.85  on 408  degrees of freedom
AIC: 367.85

Number of Fisher Scoring iterations: 5


Fold 5 Test Data Frame
   age      bmi chf miord lenfol
1  102 22.27393   1     0    169
2   83 26.38699   1     0    343
3   90 27.25264   1     1    129
4   65 27.31990   0     0   2065
5   70 23.67519   1     1    905
6   81 29.18062   0     1    550
7   58 27.19716   0     0    412
8   78 26.98943   0     0   1248
9   48 33.45110   0     0   2173
10  77 21.14409   0     0   2156
11  47 38.78883   0     0   1454
12  46 26.13850   0     0    457
13  52 28.62989   0     0   2126
14  71 32.32407   0     1   2061
15  73 26.60883   0     0   1378
16  84 20.92089   0     0   1939
17  48 24.27659   0     0   2032
18  46 26.17568   0     0   1883
19  68 27.20874   0     0    497
20  72 27.26234   1     0     69
21  83 25.97231   0     0   1926
22  46 32.57132   1     0   1189
23  81 17.18289   0     0   1295
24  78 34.17757   0     0   1936
25  80 19.65076   0     0   1325
26  83 25.49755   0     0    408
27  88 18.36663   0     1     33
28  51 40.03658   0     0    529
29  44 21.30550   0     0    398
30  45 37.65760   0     0   1105
31  63 25.06101   0     0   1919
32  78 27.72230   1     1   1235
33  56 36.96024   0     1   1451
34  63 23.33267   0     1   1889
35  53 26.60883   0     1   1940
36  50 23.88798   0     0   1979
37  55 20.83088   0     0   1847
38  73 32.48853   0     0    233
39  84 25.84315   1     1   1054
40  85 27.58664   0     1   1096
41  84 32.28350   0     0   1527
42  80 25.50204   1     1   1939
43  48 25.08833   0     0   2139
44  48 30.24444   0     0    440
45  72 33.30293   0     0   2108
46  83 25.06764   0     0   1863

Fold 5 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol  mort.prob mort.round actual
1  102 22.27393   1     0    169 0.97003192          1      1
2   83 26.38699   1     0    343 0.86100674          1      1
3   90 27.25264   1     1    129 0.95289046          1      1
4   65 27.31990   0     0   2065 0.03153785          0      0
5   70 23.67519   1     1    905 0.62301330          1      1
6   81 29.18062   0     1    550 0.63532198          1      0
7   58 27.19716   0     0    412 0.26799727          0      0
8   78 26.98943   0     0   1248 0.23745080          0      0
9   48 33.45110   0     0   2173 0.00737059          0      0
10  77 21.14409   0     0   2156 0.06854508          0      0
11  47 38.78883   0     0   1454 0.01986428          0      0
12  46 26.13850   0     0    457 0.14001296          0      0
13  52 28.62989   0     0   2126 0.01206493          0      0
14  71 32.32407   0     1   2061 0.05697506          0      0
15  73 26.60883   0     0   1378 0.15458456          0      0
16  84 20.92089   0     0   1939 0.14452998          0      0
17  48 24.27659   0     0   2032 0.01269652          0      0
18  46 26.17568   0     0   1883 0.01356498          0      0
19  68 27.20874   0     0    497 0.37454783          0      0
20  72 27.26234   1     0     69 0.82715121          1      1
21  83 25.97231   0     0   1926 0.12051914          0      1
22  46 32.57132   1     0   1189 0.09848394          0      0
23  81 17.18289   0     0   1295 0.32514059          0      0
24  78 34.17757   0     0   1936 0.06930400          0      0
25  80 19.65076   0     0   1325 0.28328705          0      0
26  83 25.49755   0     0    408 0.65876884          1      0
27  88 18.36663   0     1     33 0.90533193          1      1
28  51 40.03658   0     0    529 0.11085460          0      0
29  44 21.30550   0     0    398 0.15706038          0      0
30  45 37.65760   0     0   1105 0.03278195          0      0
31  63 25.06101   0     0   1919 0.03825548          0      0
32  78 27.72230   1     1   1235 0.57638019          1      0
33  56 36.96024   0     1   1451 0.05399114          0      0
34  63 23.33267   0     1   1889 0.06172244          0      0
35  53 26.60883   0     1   1940 0.02769759          0      0
36  50 23.88798   0     0   1979 0.01596933          0      0
37  55 20.83088   0     0   1847 0.03015247          0      0
38  73 32.48853   0     0    233 0.52220935          1      1
39  84 25.84315   1     1   1054 0.74416663          1      1
40  85 27.58664   0     1   1096 0.47955254          0      1
41  84 32.28350   0     0   1527 0.19120898          0      1
42  80 25.50204   1     1   1939 0.32963534          0      0
43  48 25.08833   0     0   2139 0.01029262          0      0
44  48 30.24444   0     0    440 0.14254865          0      0
45  72 33.30293   0     0   2108 0.03732292          0      0
46  83 25.06764   0     0   1863 0.13607026          0      0

Fold 5 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 32  3
              1  3  8

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1824  -0.6667  -0.3007   0.6237   3.2328  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.0972131  1.2958660  -2.390 0.016845 *  
age          0.0639678  0.0117767   5.432 5.58e-08 ***
bmi         -0.0332403  0.0274574  -1.211 0.226044    
chf          1.0828334  0.2898496   3.736 0.000187 ***
miord        0.3936459  0.2754489   1.429 0.152974    
lenfol      -0.0017322  0.0002377  -7.287 3.17e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 556.76  on 413  degrees of freedom
Residual deviance: 355.85  on 408  degrees of freedom
AIC: 367.85

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 5 is:
[1] 6

the total Generalization Error Rate for fold 5 is:
[1] 0.1304348
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
173 188  80      0  60   150     80 22.59674   0   1   0   0   0     1      0
338 367  58      0  55   158    102 32.77606   1   0   0   0   0     0      0
63   68  71      0  66   133     76 19.08364   0   0   0   0   0     0      1
302 325  61      0  88   130     84 28.41023   0   0   0   0   0     1      1
310 333  67      0  66   160    100 34.55598   1   0   0   1   0     1      0
39   42  75      1 114   180    110 20.19433   0   0   0   0   0     1      0
    year admitdate  disdate    fdate los dstat lenfol fstat
173    2   5/12/99  5/16/99 12/31/02   4     0   1329     0
338    3    9/7/01  9/16/01 12/31/02   9     0    480     0
63     1    7/1/97   7/5/97 12/31/02   4     0   2009     0
302    2    1/5/99  1/11/99 12/31/02   6     0   1456     0
310    2  11/21/99 11/27/99 12/31/02   6     0   1136     0
39     1   7/18/97  7/25/97  6/17/00   7     0   1065     1

Fold 6 Cross Validation Below

Summary of fold 6 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2434  -0.6135  -0.2785   0.5871   3.2581  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7695050  1.3456732  -2.801 0.005091 ** 
age          0.0703481  0.0122305   5.752 8.83e-09 ***
bmi         -0.0223809  0.0281228  -0.796 0.426132    
chf          1.1518999  0.2983788   3.861 0.000113 ***
miord        0.3712044  0.2829242   1.312 0.189511    
lenfol      -0.0017773  0.0002352  -7.558 4.10e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 555.08  on 413  degrees of freedom
Residual deviance: 342.56  on 408  degrees of freedom
AIC: 354.56

Number of Fisher Scoring iterations: 5


Fold 6 Test Data Frame
   age      bmi chf miord lenfol
1   80 22.59674   0     1   1329
2   58 32.77606   0     0    480
3   71 19.08364   0     0   2009
4   61 28.41023   0     1   1456
5   67 34.55598   1     1   1136
6   75 20.19433   0     1   1065
7   88 25.60650   1     1   1363
8   61 26.62594   0     0    418
9   91 27.61844   0     0    363
10  69 25.95993   0     1    612
11  52 32.32407   1     0   1280
12  62 33.33395   0     0   2118
13  46 25.25354   0     0    458
14  85 17.57704   0     1   1170
15  88 21.28774   0     1    406
16  55 24.95710   0     1    519
17 104 23.82665   1     0    646
18  36 31.64232   0     1   1266
19  78 22.46532   1     0    578
20  71 39.19180   1     0   1190
21  50 28.88848   0     0   1140
22  52 34.93459   0     0   1420
23  67 24.56345   0     0    397
24  88 19.04582   1     0      6
25  59 26.54491   0     0   1107
26  88 33.26210   1     1    422
27  63 27.80742   0     0    424
28  51 24.37450   1     0   2353
29  48 23.41166   0     0   1160
30  56 25.01782   0     0   2146
31  85 21.08004   1     0    446
32  57 25.84282   0     0    542
33  68 24.21079   0     0   1114
34  83 42.38277   1     1     69
35  48 26.08138   0     1   1196
36  85 21.94843   0     1   1332
37  89 14.83911   1     1     19
38  84 26.76088   1     0    659
39  76 18.35824   1     1    151
40  65 28.12934   0     0    452
41  72 27.40905   0     0   1336
42  72 26.63187   0     0   1279
43  56 29.09976   1     0   1885
44  59 21.82685   0     0    445
45  83 22.91955   0     0   1244
46  76 35.28657   0     1   1976

Fold 6 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol  mort.prob mort.round actual
1   80 22.59674   0     1   1329 0.34565337          0      0
2   58 32.77606   0     0    480 0.21823718          0      0
3   71 19.08364   0     0   2009 0.05883024          0      0
4   61 28.41023   0     1   1456 0.08861682          0      0
5   67 34.55598   1     1   1136 0.41934363          0      0
6   75 20.19433   0     1   1065 0.38533379          0      1
7   88 25.60650   1     1   1363 0.72085270          1      0
8   61 26.62594   0     0    418 0.30638222          0      0
9   91 27.61844   0     0    363 0.79720139          1      1
10  69 25.95993   0     1    612 0.44695384          0      1
11  52 32.32407   1     0   1280 0.12369754          0      0
12  62 33.33395   0     0   2118 0.01948831          0      0
13  46 25.25354   0     0    458 0.12867945          0      0
14  85 17.57704   0     1   1170 0.52709192          1      0
15  88 21.28774   0     1    406 0.83122264          1      1
16  55 24.95710   0     1    519 0.26695481          0      0
17 104 23.82665   1     0    646 0.95334562          1      1
18  36 31.64232   0     1   1266 0.02137352          0      0
19  78 22.46532   1     0    578 0.79240486          1      0
20  71 39.19180   1     0   1190 0.35091775          0      0
21  50 28.88848   0     0   1140 0.05094325          0      0
22  52 34.93459   0     0   1420 0.03176783          0      0
23  67 24.56345   0     0    397 0.42274487          0      0
24  88 19.04582   1     0      6 0.95835767          1      1
25  59 26.54491   0     0   1107 0.10151336          0      0
26  88 33.26210   1     1    422 0.92054563          1      1
27  63 27.80742   0     0    424 0.32882644          0      0
28  51 24.37450   1     0   2353 0.02281336          0      1
29  48 23.41166   0     0   1160 0.04841026          0      0
30  56 25.01782   0     0   2146 0.01471607          0      0
31  85 21.08004   1     0    446 0.89066242          1      1
32  57 25.84282   0     0    542 0.21394011          0      0
33  68 24.21079   0     0   1114 0.18129628          0      0
34  83 42.38277   1     1     69 0.92562139          1      1
35  48 26.08138   0     1   1196 0.06117153          0      0
36  85 21.94843   0     1   1332 0.43112020          0      0
37  89 14.83911   1     1     19 0.97463522          1      1
38  84 26.76088   1     0    659 0.82075525          1      0
39  76 18.35824   1     1    151 0.91840067          1      1
40  65 28.12934   0     0    452 0.34756262          0      0
41  72 27.40905   0     0   1336 0.15546902          0      0
42  72 26.63187   0     0   1279 0.17169873          0      1
43  56 29.09976   1     0   1885 0.06418937          0      0
44  59 21.82685   0     0    445 0.28938707          0      0
45  83 22.91955   0     0   1244 0.34197257          0      0
46  76 35.28657   0     1   1976 0.08678735          0      0

Fold 6 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 29  4
              1  4  9

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2434  -0.6135  -0.2785   0.5871   3.2581  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7695050  1.3456732  -2.801 0.005091 ** 
age          0.0703481  0.0122305   5.752 8.83e-09 ***
bmi         -0.0223809  0.0281228  -0.796 0.426132    
chf          1.1518999  0.2983788   3.861 0.000113 ***
miord        0.3712044  0.2829242   1.312 0.189511    
lenfol      -0.0017773  0.0002352  -7.558 4.10e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 555.08  on 413  degrees of freedom
Residual deviance: 342.56  on 408  degrees of freedom
AIC: 354.56

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 6 is:
[1] 8

the total Generalization Error Rate for fold 6 is:
[1] 0.173913
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
152 163  84      1 104   128     71 15.72971   0   1   0   0   0     0      0
235 256  53      1  96   170     99 44.83886   1   0   0   0   0     1      0
375 404  66      0 110   136     80 29.99814   0   0   0   0   0     0      0
408 444  46      0  80   115     62 31.13646   0   0   0   0   0     0      1
283 306  82      0  92   141     79 23.71988   1   0   0   1   0     1      1
407 443  46      0  97   149     83 25.54051   0   0   0   0   0     0      0
    year admitdate  disdate    fdate los dstat lenfol fstat
152    2    1/3/99  1/30/99 12/27/99  27     0    358     1
235    2    9/1/99   9/5/99 12/23/00   4     0    479     1
375    3   5/23/01  5/29/01 12/31/02   6     0    587     0
408    3  11/15/01 11/21/01 12/31/02   6     0    411     0
283    2   5/17/99  5/21/99  6/12/99   4     0     26     1
407    3  12/28/01 12/29/01 12/31/02   1     0    368     0

Fold 7 Cross Validation Below

Summary of fold 7 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2658  -0.5924  -0.2500   0.5396   3.3301  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7239745  1.4361818  -2.593  0.00952 ** 
age          0.0755305  0.0130983   5.766 8.10e-09 ***
bmi         -0.0424210  0.0310439  -1.366  0.17179    
chf          1.1803341  0.3084866   3.826  0.00013 ***
miord        0.3991853  0.2920656   1.367  0.17170    
lenfol      -0.0018635  0.0002506  -7.436 1.04e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 547.52  on 413  degrees of freedom
Residual deviance: 321.13  on 408  degrees of freedom
AIC: 333.13

Number of Fisher Scoring iterations: 5


Fold 7 Test Data Frame
   age      bmi chf miord lenfol
1   84 15.72971   0     0    358
2   53 44.83886   0     1    479
3   66 29.99814   0     0    587
4   46 31.13646   0     0    411
5   82 23.71988   1     1     26
6   46 25.54051   0     0    368
7   66 33.00178   1     0   1234
8   46 24.24850   0     1    486
9   67 22.09684   1     1    609
10  78 30.23193   1     0   1157
11  88 21.28707   0     1     52
12  45 34.14385   0     0    416
13  56 28.31856   0     0    445
14  49 33.28196   0     0   1385
15  54 18.56161   1     0    865
16  84 23.24075   0     0     93
17  40 36.58072   0     0    516
18  72 28.56874   0     1   1627
19  73 24.21079   0     0   1904
20  80 27.91060   1     0    359
21  73 24.46224   1     1   1377
22  72 31.55458   1     0    673
23  45 31.32463   0     0    573
24  86 24.23672   0     1    197
25  82 17.63944   0     0    551
26  37 30.68397   0     0   2152
27  61 31.47403   0     1   1150
28  46 22.65552   0     1   2006
29  49 35.27571   0     0   2358
30  55 27.11609   0     0   1496
31  54 28.88959   1     1    562
32  84 29.22863   0     0   2064
33  41 20.08804   0     0    522
34  85 27.29121   1     0    419
35  58 34.43664   0     0      7
36  73 25.22630   0     1     76
37  74 19.72534   0     0   1576
38  71 23.43605   0     0   1187
39  71 39.99462   0     0    405
40  68 35.67057   1     1    132
41  79 33.82198   0     0   1384
42  85 21.96576   1     0     34
43  71 34.01093   0     0   1279
44  87 23.04545   1     1    521
45  65 39.65132   0     1    451
46  64 26.79328   0     0   1454

Fold 7 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol   mort.prob mort.round actual
1   84 15.72971   0     0    358 0.783500302          1      1
2   53 44.83886   0     1    479 0.107512781          0      1
3   66 29.99814   0     0    587 0.248730938          0      0
4   46 31.13646   0     0    411 0.088159835          0      0
5   82 23.71988   1     1     26 0.952319381          1      1
6   46 25.54051   0     0    368 0.117243493          0      0
7   66 33.00178   1     0   1234 0.221289587          0      0
8   46 24.24850   0     1    486 0.143724105          0      0
9   67 22.09684   1     1    609 0.699273697          1      0
10  78 30.23193   1     0   1157 0.477312926          0      0
11  88 21.28707   0     1     52 0.910680750          1      1
12  45 34.14385   0     0    416 0.072511327          0      0
13  56 28.31856   0     0    445 0.178751482          0      0
14  49 33.28196   0     0   1385 0.017709329          0      0
15  54 18.56161   1     0    865 0.296435206          0      1
16  84 23.24075   0     0     93 0.811744711          1      1
17  40 36.58072   0     0    516 0.038563735          0      0
18  72 28.56874   0     1   1627 0.106173361          0      1
19  73 24.21079   0     0   1904 0.058117297          0      0
20  80 27.91060   1     0    359 0.838323327          1      1
21  73 24.46224   1     1   1377 0.441643575          0      1
22  72 31.55458   1     0    673 0.574891637          1      1
23  45 31.32463   0     0    573 0.061704103          0      0
24  86 24.23672   0     1    197 0.855149996          1      1
25  82 17.63944   0     0    551 0.666956334          1      0
26  37 30.68397   0     0   2152 0.001943604          0      0
27  61 31.47403   0     1   1150 0.100144069          0      0
28  46 22.65552   0     1   2006 0.010460244          0      0
29  49 35.27571   0     0   2358 0.002695241          0      1
30  55 27.11609   0     0   1496 0.029088286          0      1
31  54 28.88959   1     1    562 0.416143446          0      1
32  84 29.22863   0     0   2064 0.078304832          0      0
33  41 20.08804   0     0    522 0.079282882          0      0
34  85 27.29121   1     0    419 0.874123724          1      1
35  58 34.43664   0     0      7 0.306382689          0      1
36  73 25.22630   0     1     76 0.726549747          1      1
37  74 19.72534   0     0   1576 0.129163184          0      1
38  71 23.43605   0     0   1187 0.172576538          0      0
39  71 39.99462   0     0    405 0.307327971          0      1
40  68 35.67057   1     1    132 0.774248112          1      1
41  79 33.82198   0     0   1384 0.145427361          0      0
42  85 21.96576   1     0     34 0.946913500          1      1
43  71 34.01093   0     0   1279 0.100877196          0      0
44  87 23.04545   1     1    521 0.922599363          1      0
45  65 39.65132   0     1    451 0.281345494          0      0
46  64 26.79328   0     0   1454 0.060872833          0      0

Fold 7 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 22  3
              1 10 11

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2658  -0.5924  -0.2500   0.5396   3.3301  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7239745  1.4361818  -2.593  0.00952 ** 
age          0.0755305  0.0130983   5.766 8.10e-09 ***
bmi         -0.0424210  0.0310439  -1.366  0.17179    
chf          1.1803341  0.3084866   3.826  0.00013 ***
miord        0.3991853  0.2920656   1.367  0.17170    
lenfol      -0.0018635  0.0002506  -7.436 1.04e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 547.52  on 413  degrees of freedom
Residual deviance: 321.13  on 408  degrees of freedom
AIC: 333.13

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 7 is:
[1] 13

the total Generalization Error Rate for fold 7 is:
[1] 0.2826087
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
7  8  55      0 91   147     95 27.11609   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
7   1/11/97 1/15/97  2/15/01   4     0   1496     1
     id age gender  hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
83   90  82      1  83   148     70 17.89146   1   0   0   0   0     0      0
316 339  79      0  68   210    150 24.85641   1   1   0   1   0     1      0
314 337  63      0 100   140     80 25.94190   1   0   0   0   0     0      0
127 138  58      0  90   116     67 21.28707   0   0   0   0   0     1      1
361 390  87      1 120   140     70 27.34205   1   0   0   1   0     0      0
130 141  48      0  59   125     76 33.00178   0   0   0   0   0     0      1
    year admitdate  disdate    fdate los dstat lenfol fstat
83     1   10/7/97 10/14/97  5/30/98   7     0    235     1
316    2    5/5/99  5/18/99 12/31/02  13     0   1336     0
314    2  10/10/99 10/17/99 12/31/02   7     0   1178     0
127    1   4/14/97  4/22/97  6/16/00   8     0   1159     1
361    3   5/21/01  5/25/01 12/31/02   4     0    589     0
130    1  10/19/97 10/22/97 12/31/02   3     0   1899     0

Fold 8 Cross Validation Below

Summary of fold 8 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1687  -0.6162  -0.3002   0.5816   3.2286  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.2468942  1.3434117  -3.161  0.00157 ** 
age          0.0706277  0.0123193   5.733 9.86e-09 ***
bmi         -0.0140323  0.0276586  -0.507  0.61192    
chf          1.2771450  0.2923407   4.369 1.25e-05 ***
miord        0.2674660  0.2847115   0.939  0.34751    
lenfol      -0.0016646  0.0002374  -7.012 2.35e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 545.42  on 413  degrees of freedom
Residual deviance: 342.18  on 408  degrees of freedom
AIC: 354.18

Number of Fisher Scoring iterations: 5


Fold 8 Test Data Frame
   age      bmi chf miord lenfol
1   82 17.89146   0     0    235
2   79 24.85641   1     1   1336
3   63 25.94190   0     0   1178
4   58 21.28707   0     1   1159
5   87 27.34205   1     0    589
6   48 33.00178   0     0   1899
7   66 23.40377   0     0   1290
8   57 18.60004   0     0     95
9   62 23.26372   0     1    297
10  47 28.12934   0     1   1102
11  87 19.35421   1     1    295
12  57 25.82748   0     0   1273
13  64 26.36032   0     0    475
14  77 20.98750   0     0    382
15  82 18.79667   0     0    192
16  36 31.64232   0     1   1266
17  53 31.64232   1     1     32
18  82 23.88798   1     0    140
19  76 32.72025   0     0   1251
20  83 26.88683   1     0    552
21  75 26.78256   0     1   1125
22  57 39.49046   0     0   2122
23  76 27.45762   1     0    146
24  77 23.42975   0     1   1374
25  81 25.82484   0     1     60
26  93 25.50204   1     0    109
27  90 24.56345   0     1   1224
28  74 30.13206   0     1   1624
29  77 30.56876   0     1    467
30  73 27.34205   0     1   2125
31  90 23.41166   1     0     19
32  45 37.06646   0     0   1262
33  82 23.92337   0     0    559
34  59 27.45762   0     1   1893
35  54 34.84510   1     0   1954
36  93 22.85147   0     0    442
37  82 19.61451   0     0    169
38  76 28.95531   0     1    187
39  78 24.40771   0     0     81
40  73 28.58549   0     1   1954
41  71 23.43605   0     0   1187
42  59 29.29506   1     1   1831
43  95 15.92695   0     1   1553
44  39 28.24651   0     0   1203
45  64 22.15127   0     0    407
46  64 28.05828   0     1   1438

Fold 8 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol  mort.prob mort.round actual
1   82 17.89146   0     0    235 0.71142808          1      1
2   79 24.85641   1     1   1336 0.57555525          1      0
3   63 25.94190   0     0   1178 0.10694633          0      0
4   58 21.28707   0     1   1159 0.10802782          0      1
5   87 27.34205   1     0    589 0.85944855          1      0
6   48 33.00178   0     0   1899 0.01119524          0      0
7   66 23.40377   0     0   1290 0.11291950          0      0
8   57 18.60004   0     0     95 0.34518867          0      1
9   62 23.26372   0     1    297 0.39619350          0      1
10  47 28.12934   0     1   1102 0.05269608          0      0
11  87 19.35421   1     1    295 0.93581663          1      1
12  57 25.82748   0     0   1273 0.06281886          0      0
13  64 26.36032   0     0    475 0.29166318          0      0
14  77 20.98750   0     0    382 0.56489308          1      1
15  82 18.79667   0     0    192 0.72336349          1      1
16  36 31.64232   0     1   1266 0.01819439          0      0
17  53 31.64232   1     1     32 0.63267363          1      1
18  82 23.88798   1     0    140 0.90494954          1      1
19  76 32.72025   0     0   1251 0.19453720          0      0
20  83 26.88683   1     0    552 0.83148465          1      1
21  75 26.78256   0     1   1125 0.28274391          0      0
22  57 39.49046   0     0   2122 0.01328659          0      0
23  76 27.45762   1     0    146 0.85441129          1      1
24  77 23.42975   0     1   1374 0.23919750          0      0
25  81 25.82484   0     1     60 0.78230630          1      1
26  93 25.50204   1     0    109 0.95518367          1      1
27  90 24.56345   0     1   1224 0.49871599          0      0
28  74 30.13206   0     1   1624 0.13248351          0      1
29  77 30.56876   0     1    467 0.56280881          1      1
30  73 27.34205   0     1   2125 0.06039011          0      0
31  90 23.41166   1     0     19 0.95376140          1      1
32  45 37.06646   0     0   1262 0.02437427          0      0
33  82 23.92337   0     0    559 0.56914038          1      1
34  59 27.45762   0     1   1893 0.03393277          0      0
35  54 34.84510   1     0   1954 0.05227640          0      0
36  93 22.85147   0     0    442 0.77989488          1      1
37  82 19.61451   0     0    169 0.72869627          1      1
38  76 28.95531   0     1    187 0.66165579          1      1
39  78 24.40771   0     0     81 0.68669999          1      1
40  73 28.58549   0     1   1954 0.07745537          0      1
41  71 23.43605   0     0   1187 0.17695479          0      0
42  59 29.29506   1     1   1831 0.11980450          0      0
43  95 15.92695   0     1   1553 0.48039131          0      1
44  39 28.24651   0     0   1203 0.02000942          0      0
45  64 22.15127   0     0    407 0.32848129          0      0
46  64 28.05828   0     1   1438 0.09563188          0      0

Fold 8 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 21  2
              1  6 17

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1687  -0.6162  -0.3002   0.5816   3.2286  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.2468942  1.3434117  -3.161  0.00157 ** 
age          0.0706277  0.0123193   5.733 9.86e-09 ***
bmi         -0.0140323  0.0276586  -0.507  0.61192    
chf          1.2771450  0.2923407   4.369 1.25e-05 ***
miord        0.2674660  0.2847115   0.939  0.34751    
lenfol      -0.0016646  0.0002374  -7.012 2.35e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 545.42  on 413  degrees of freedom
Residual deviance: 342.18  on 408  degrees of freedom
AIC: 354.18

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 8 is:
[1] 8

the total Generalization Error Rate for fold 8 is:
[1] 0.173913
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
     id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
149 160  74      1 82   104     85 24.50908   1   0   1   0   0     0      1
258 281  64      0 94   198    107 28.19217   1   0   0   0   0     0      1
129 140  76      1 69   171     96 20.07066   1   0   0   0   0     1      0
111 122  84      0 62   234    110 25.46070   1   0   0   0   0     0      1
289 312  59      0 45   167    117 40.75002   1   0   0   0   0     0      0
50   53  80      1 42   120     55 24.71770   1   1   0   1   0     1      0
    year admitdate  disdate    fdate los dstat lenfol fstat
149    1   3/18/97   4/3/97 12/31/02  16     0   2114     0
258    2   9/11/99  9/15/99 12/31/02   4     0   1207     0
129    1  12/16/97 12/20/97  4/16/01   4     0   1217     1
111    1   12/3/97  12/8/97 12/31/02   5     0   1854     0
289    2   12/4/99 12/10/99 12/31/02   6     0   1123     0
50     1    5/9/97  5/23/97  3/10/99  14     0    670     1

Fold 9 Cross Validation Below

Summary of fold 9 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1960  -0.6493  -0.2947   0.6090   3.1948  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7118229  1.3141291  -2.825 0.004735 ** 
age          0.0665606  0.0118014   5.640 1.70e-08 ***
bmi         -0.0182761  0.0277960  -0.658 0.510855    
chf          1.1476539  0.2954349   3.885 0.000102 ***
miord        0.3960072  0.2811370   1.409 0.158956    
lenfol      -0.0016973  0.0002334  -7.271 3.56e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 551.46  on 413  degrees of freedom
Residual deviance: 348.64  on 408  degrees of freedom
AIC: 360.64

Number of Fisher Scoring iterations: 5


Fold 9 Test Data Frame
   age      bmi chf miord lenfol
1   74 24.50908   0     0   2114
2   64 28.19217   0     0   1207
3   76 20.07066   0     1   1217
4   84 25.46070   0     0   1854
5   59 40.75002   0     0   1123
6   80 24.71770   1     1    670
7   70 22.43533   0     1     55
8   86 26.92577   1     0   1964
9   84 27.97729   0     1   1317
10  86 24.00954   1     1    312
11  85 16.09312   1     1     49
12  62 35.15407   0     0    445
13  76 27.96454   0     0     10
14  52 38.69089   0     0    422
15  72 25.49755   0     0   1232
16  39 25.08833   1     0   1883
17  79 27.81148   0     0   1103
18  75 21.28707   1     0    100
19  93 23.72658   1     1      7
20  91 27.12480   1     0    313
21  62 26.79198   0     0   1365
22  83 28.16715   1     0    108
23  73 19.05009   1     1    143
24  37 30.13206   0     0   1108
25  50 29.85998   0     1   1433
26  84 32.11709   1     1    371
27  52 42.76594   0     0   2151
28  65 23.70721   0     1   1257
29  79 19.20723   0     1    644
30  77 24.87489   0     0   1969
31  46 23.62803   0     1   1211
32  82 26.88683   0     0    936
33  68 31.63788   1     1    530
34  85 22.39711   0     0    953
35  83 35.70335   0     0   1317
36  59 25.82484   0     0   1346
37  66 25.54448   0     1    403
38  65 28.87434   0     0    373
39  75 21.00559   0     1    606
40  70 29.23968   1     0   1223
41  68 28.88818   1     0    589
42  73 21.28469   0     0    458
43  81 35.96007   0     1   1162
44  54 21.96609   1     0   1408
45  81 24.54718   0     0   1121
46  74 20.67452   1     0    345

Fold 9 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol   mort.prob mort.round actual
1   74 24.50908   0     0   2114 0.056130472          0      0
2   64 28.19217   0     0   1207 0.117554217          0      0
3   76 20.07066   0     1   1217 0.334120570          0      1
4   84 25.46070   0     0   1854 0.150229421          0      0
5   59 40.75002   0     0   1123 0.080502617          0      0
6   80 24.71770   1     1    670 0.827465535          1      1
7   70 22.43533   0     1     55 0.698475379          1      1
8   86 26.92577   1     0   1964 0.339504337          0      0
9   84 27.97729   0     1   1317 0.384296435          0      0
10  86 24.00954   1     1    312 0.930065869          1      1
11  85 16.09312   1     1     49 0.957393419          1      1
12  62 35.15407   0     0    445 0.272330579          0      0
13  76 27.96454   0     0     10 0.693966717          1      1
14  52 38.69089   0     0    422 0.157886535          0      0
15  72 25.49755   0     0   1232 0.185957015          0      0
16  39 25.08833   1     0   1883 0.026013230          0      0
17  79 27.81148   0     0   1103 0.302818092          0      0
18  75 21.28707   1     0    100 0.866354833          1      1
19  93 23.72658   1     1      7 0.972786904          1      1
20  91 27.12480   1     0    313 0.921713958          1      1
21  62 26.79198   0     0   1365 0.083823263          0      0
22  83 28.16715   1     0    108 0.905703876          1      1
23  73 19.05009   1     1    143 0.890892726          1      1
24  37 30.13206   0     0   1108 0.024593848          0      0
25  50 29.85998   0     1   1433 0.048999487          0      0
26  84 32.11709   1     1    371 0.900810880          1      0
27  52 42.76594   0     0   2151 0.009165461          0      0
28  65 23.70721   0     1   1257 0.174203188          0      0
29  79 19.20723   0     1    644 0.622082030          1      1
30  77 24.87489   0     0   1969 0.084462190          0      0
31  46 23.62803   0     1   1211 0.060582361          0      0
32  82 26.88683   0     0    936 0.417294898          0      1
33  68 31.63788   1     1    530 0.706861207          1      1
34  85 22.39711   0     0    953 0.479759681          0      1
35  83 35.70335   0     0   1317 0.254430420          0      1
36  59 25.82484   0     0   1346 0.073016060          0      0
37  66 25.54448   0     1    403 0.481590947          0      0
38  65 28.87434   0     0    373 0.366752132          0      0
39  75 21.00559   0     1    606 0.565565740          1      0
40  70 29.23968   1     0   1223 0.374003204          0      0
41  68 28.88818   1     0    589 0.606898885          1      0
42  73 21.28469   0     0    458 0.495187552          0      0
43  81 35.96007   0     1   1162 0.364971852          0      0
44  54 21.96609   1     0   1408 0.146650812          0      0
45  81 24.54718   0     0   1121 0.338119575          0      0
46  74 20.67452   1     0    345 0.801851688          1      1

Fold 9 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 26  3
              1  4 13

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1960  -0.6493  -0.2947   0.6090   3.1948  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.7118229  1.3141291  -2.825 0.004735 ** 
age          0.0665606  0.0118014   5.640 1.70e-08 ***
bmi         -0.0182761  0.0277960  -0.658 0.510855    
chf          1.1476539  0.2954349   3.885 0.000102 ***
miord        0.3960072  0.2811370   1.409 0.158956    
lenfol      -0.0016973  0.0002334  -7.271 3.56e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 551.46  on 413  degrees of freedom
Residual deviance: 348.64  on 408  degrees of freedom
AIC: 360.64

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 9 is:
[1] 7

the total Generalization Error Rate for fold 9 is:
[1] 0.1521739
  id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype year
1  1  83      0 89   152     78 25.54051   1   1   0   0   0     1      0    1
2  2  49      0 84   120     60 24.02398   1   0   0   0   0     0      1    1
3  3  70      1 83   147     88 22.14290   0   0   0   0   0     0      1    1
4  4  70      0 65   123     76 26.63187   1   0   0   1   0     0      1    1
5  5  70      0 63   135     85 24.41255   1   0   0   0   0     0      1    1
6  7  57      0 73   191    116 39.49046   1   0   0   0   0     0      1    1
  admitdate disdate    fdate los dstat lenfol fstat
1   1/13/97 1/18/97 12/31/02   5     0   2178     0
2   1/19/97 1/24/97 12/31/02   5     0   2172     0
3    1/1/97  1/6/97 12/31/02   5     0   2190     0
4   2/17/97 2/27/97 12/11/97  10     0    297     1
5    3/1/97  3/7/97 12/31/02   6     0   2131     0
6   3/10/97 3/15/97 12/31/02   5     0   2122     0
     id age gender hr sysbp diasbp      bmi cvd afb sho chf av3 miord mitype
73   79  71      1 53   123     56 24.37440   0   0   0   0   0     0      0
53   57  65      1 81   197     84 30.17909   1   0   0   0   0     0      0
309 332  74      0 60   140     70 36.76362   1   0   0   0   0     1      0
282 305  57      1 81   200    110 38.10646   1   0   0   0   0     0      0
123 134  64      0 77   124     73 25.76880   0   0   0   0   0     0      0
276 299  93      0 61   172     71 22.55374   1   0   0   1   0     1      0
    year admitdate  disdate    fdate los dstat lenfol fstat
73     1    9/7/97   9/9/97 12/31/02   2     0   1941     0
53     1   7/17/97  7/26/97  9/19/97   9     0     64     1
309    2  10/19/99 10/22/99 12/31/02   3     0   1169     0
282    2   12/1/99 12/13/99 12/31/02  12     0   1126     0
123    1   11/7/97 11/11/97 12/31/02   4     0   1880     0
276    2  10/10/99 10/14/99  2/18/01   4     0    497     1

Fold 10 Cross Validation Below

Summary of fold 10 Training Analysis Below

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1329  -0.6488  -0.2974   0.6122   3.2338  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.1333856  1.3190887  -2.375 0.017529 *  
age          0.0631727  0.0120220   5.255 1.48e-07 ***
bmi         -0.0293252  0.0278693  -1.052 0.292689    
chf          1.0496430  0.2967739   3.537 0.000405 ***
miord        0.3467253  0.2802132   1.237 0.215953    
lenfol      -0.0017604  0.0002366  -7.440 1.01e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 549.53  on 413  degrees of freedom
Residual deviance: 348.14  on 408  degrees of freedom
AIC: 360.14

Number of Fisher Scoring iterations: 5


Fold 10 Test Data Frame
   age      bmi chf miord lenfol
1   71 24.37440   0     0   1941
2   65 30.17909   0     0     64
3   74 36.76362   0     1   1169
4   57 38.10646   0     0   1126
5   64 25.76880   0     0   1880
6   93 22.55374   1     1    497
7   83 22.04732   0     1    849
8   61 24.66175   0     1   2168
9   86 20.50654   0     1    118
10  75 35.96007   0     0   1200
11  69 32.28435   1     0    259
12  60 27.34205   0     0    386
13  72 23.73719   1     1   1536
14  43 24.21079   1     1     18
15  82 16.87915   0     0    631
16  91 25.84282   0     0   1233
17  46 26.49980   1     0   1123
18  73 28.45241   1     1    399
19  57 24.96147   0     0    573
20  53 36.58893   0     0    554
21  75 25.34063   0     0    675
22  66 33.28196   1     0    400
23  56 25.82484   0     0   1430
24  68 30.71420   1     1     20
25  51 37.90281   0     0    437
26  57 20.65988   0     0   2025
27  64 28.19217   1     0   1409
28  51 25.67865   0     0    386
29  59 26.63187   0     0    568
30  59 28.62989   0     0   1444
31  89 22.86295   1     0    200
32  72 29.70193   0     1    459
33  79 24.03110   1     1    166
34  91 24.21079   0     1    140
35  74 30.46863   1     1   1232
36  62 26.43421   1     0     18
37  42 33.75237   0     1    544
38  85 29.18062   0     0   1320
39  86 19.85515   0     0    465
40  71 31.63866   1     1    649
41  60 20.82128   0     0   1109
42  30 29.85998   0     0   1923
43  60 20.46840   0     0   1887
44  87 25.58435   0     0   1359
45  89 19.52617   1     0      6
46  35 38.59773   0     0   2086

Fold 10 Test Data Set Cross Validation Below
   age      bmi chf miord lenfol   mort.prob mort.round actual
1   71 24.37440   0     0   1941 0.058420309          0      0
2   65 30.17909   0     0     64 0.493791406          0      1
3   74 36.76362   0     1   1169 0.223060502          0      0
4   57 38.10646   0     0   1126 0.067090790          0      0
5   64 25.76880   0     0   1880 0.040870826          0      0
6   93 22.55374   1     1    497 0.930972079          1      1
7   83 22.04732   0     1    849 0.578234323          1      1
8   61 24.66175   0     1   2168 0.030092046          0      0
9   86 20.50654   0     1    118 0.862605651          1      1
10  75 35.96007   0     0   1200 0.173290933          0      1
11  69 32.28435   1     0    259 0.705261030          1      1
12  60 27.34205   0     0    386 0.304839041          0      0
13  72 23.73719   1     1   1536 0.356934187          0      1
14  43 24.21079   1     1     18 0.559155297          1      1
15  82 16.87915   0     0    631 0.608488173          1      0
16  91 25.84282   0     0   1233 0.422352931          0      1
17  46 26.49980   1     0   1123 0.126543862          0      0
18  73 28.45241   1     1    399 0.792129008          1      0
19  57 24.96147   0     0    573 0.218698633          0      0
20  53 36.58893   0     0    554 0.137823471          0      0
21  75 25.34063   0     0    675 0.419009629          0      0
22  66 33.28196   1     0    400 0.600004691          1      0
23  56 25.82484   0     0   1430 0.053634189          0      0
24  68 30.71420   1     1     20 0.835183289          1      1
25  51 37.90281   0     0    437 0.142779746          0      0
26  57 20.65988   0     0   2025 0.024050389          0      0
27  64 28.19217   1     0   1409 0.206218582          0      0
28  51 25.67865   0     0    386 0.206831016          0      0
29  59 26.63187   0     0    568 0.233777362          0      0
30  59 28.62989   0     0   1444 0.057985429          0      0
31  89 22.86295   1     0    200 0.925261501          1      1
32  72 29.70193   0     1    459 0.520668960          1      0
33  79 24.03110   1     1    166 0.905224987          1      1
34  91 24.21079   0     1    140 0.881384691          1      1
35  74 30.46863   1     1   1232 0.468894837          0      1
36  62 26.43421   1     0     18 0.736156802          1      1
37  42 33.75237   0     1    544 0.110969737          0      0
38  85 29.18062   0     0   1320 0.280255103          0      0
39  86 19.85515   0     0    465 0.710664071          1      1
40  71 31.63866   1     1    649 0.663273719          1      1
41  60 20.82128   0     0   1109 0.129439387          0      0
42  30 29.85998   0     0   1923 0.004073570          0      0
43  60 20.46840   0     0   1887 0.036784955          0      0
44  87 25.58435   0     0   1359 0.314309861          0      1
45  89 19.52617   1     0      6 0.950520693          1      1
46  35 38.59773   0     0   2086 0.003247957          0      0

Fold 10 Confusion Matrix of Predicted versus Acutal Mortality
               new.data$mort.round
new.data$actual  0  1
              0 23  4
              1  6 13

Call:
glm(formula = fstat ~ age + bmi + chf + miord + lenfol, family = "binomial", 
    data = train.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1329  -0.6488  -0.2974   0.6122   3.2338  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.1333856  1.3190887  -2.375 0.017529 *  
age          0.0631727  0.0120220   5.255 1.48e-07 ***
bmi         -0.0293252  0.0278693  -1.052 0.292689    
chf          1.0496430  0.2967739   3.537 0.000405 ***
miord        0.3467253  0.2802132   1.237 0.215953    
lenfol      -0.0017604  0.0002366  -7.440 1.01e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 549.53  on 413  degrees of freedom
Residual deviance: 348.14  on 408  degrees of freedom
AIC: 360.14

Number of Fisher Scoring iterations: 5


The Total number of Generaliztion Errors for fold 10 is:
[1] 10

the total Generalization Error Rate for fold 10 is:
[1] 0.2173913

the Total Number of Generalization Errors for this analysis is:
[1] 80

Below are the Generaliztion Errors for each analysis:
 [1] 0.1304348 0.1739130 0.1304348 0.1739130 0.1304348 0.1739130 0.2826087
 [8] 0.1739130 0.1521739 0.2173913

the Overall Generalization Error Rate for this analyis is:
[1] 0.173913
> 
> 
